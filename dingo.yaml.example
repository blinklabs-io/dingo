# Example config file for dingo
# The values shown below correspond to the in-code defaults

# Public bind address for the Dingo server
bindAddr: "0.0.0.0"

# Path to the Cardano node configuration file
#
# Can be overridden with the config environment variable
cardanoConfig: "./config/cardano/preview/config.json"

# Database configuration
database:
  # Blob storage plugin configuration
  blob:
    # Plugin to use for blob storage (badger, gcs, s3)
    plugin: "badger"
    # Configuration options for each plugin
    badger:
      # Data directory for BadgerDB storage
      data-dir: ".dingo/badger"
      # Block cache size in bytes (default: 1610612736 ~1.5GB)
      block-cache-size: 1610612736
      # Index cache size in bytes (default: 536870912 ~512MB)
      index-cache-size: 536870912
      # Enable garbage collection (default: true)
      gc: true
    gcs:
      # Google Cloud Storage bucket name
      bucket: ""
      # Google Cloud project ID
      project-id: ""
      # Path prefix within the bucket
      prefix: ""
    s3:
      # AWS Endpoint
      endpoint: ""
      # AWS S3 bucket name
      bucket: ""
      # AWS region
      region: ""
      # Path prefix within the bucket
      prefix: ""
      # AWS access key ID (optional - uses default credential chain if not set)
      access-key-id: ""
      # AWS secret access key (optional - uses default credential chain if not set)
      secret-access-key: ""

  # Metadata storage plugin configuration
  metadata:
    # Plugin to use for metadata storage (sqlite, postgres, mysql)
    plugin: "sqlite"
    # Configuration options for each plugin
    sqlite:
      # Path to SQLite database file
      data-dir: ".dingo/metadata.db"
    postgres:
      # NOTE: These are example values for local development only.
      # Do not use these credentials in production environments.
      # Postgres host
      host: "localhost"
      # Postgres port
      port: 5432
      # Postgres user
      user: "postgres"
      # Postgres password (required - no default)
      password: ""
      # Postgres database name
      database: "postgres"
      # Postgres sslmode
      ssl-mode: "disable"
      # Postgres TimeZone
      timezone: "UTC"
      # Full Postgres DSN (overrides other options when set)
      dsn: ""
    mysql:
      # NOTE: These are example values for local development only.
      # Do not use these credentials in production environments.
      # MySQL host
      host: "localhost"
      # MySQL port
      port: 3306
      # MySQL user
      user: "root"
      # MySQL password (required - no default)
      password: ""
      # MySQL database name
      database: "mysql"
      # MySQL TLS mode (mapped to tls= in DSN)
      ssl-mode: ""
      # MySQL time zone location
      timezone: "UTC"
      # Full MySQL DSN (overrides other options when set)
      dsn: ""

# Path to the UNIX domain socket file used by the server
socketPath: "dingo.socket"

# Name of the Cardano network
network: "preview"

# TLS certificate file path (for HTTPS)
#
# Can be overridden with the TLS_CERT_FILE_PATH environment variable
tlsCertFilePath: ""

# TLS key file path (for HTTPS)
#
# Can be overridden with the TLS_KEY_FILE_PATH environment variable
tlsKeyFilePath: ""

# Path to the topology configuration file for Cardano node
topology: ""

# TCP port to bind for Prometheus metrics endpoint
metricsPort: 12798

# Internal/private address to bind for listening for Ouroboros NtC
privateBindAddr: "127.0.0.1"

# TCP port to bind for listening for Ouroboros NtC
privatePort: 3002

# TCP port to bind for listening for Ouroboros NtN
#
# Can be overridden with the port environment variable
relayPort: 3001

# Storage mode controls how much data is persisted.
# - "core": Only consensus data (UTxOs, certs, pools, pparams). Suitable for
#   block producers and relay nodes with no APIs enabled.
# - "api": Core data plus full transaction metadata (witnesses, scripts, datums,
#   redeemers). Required when any API is enabled.
# APIs will refuse to start if storage mode is not "api".
#
# Can be overridden with DINGO_STORAGE_MODE
storageMode: "core"

# API ports (0 = disabled, default)
# All APIs require storageMode: "api"
#
# UTxO RPC gRPC API port
# Can be overridden with DINGO_UTXORPC_PORT
utxorpcPort: 0
# Blockfrost-compatible REST API port
# Can be overridden with DINGO_BLOCKFROST_PORT
blockfrostPort: 0
# Mesh (Coinbase Rosetta) REST API port
# Can be overridden with DINGO_MESH_PORT
meshPort: 0

# base url of bark archive server
barkBaseUrl: ""

# number of slots from tip within which blocks
# will not be found in the bark archive
barkSecurityWindow: 10000

# TCP port bind for listening for bark RPC calls
barkPort: 0

# ---
# Deployment pattern examples (uncomment one block):
#
# Relay node (core storage, no APIs):
#   storageMode: "core"
#   blockProducer: false
#
# Data node (API storage, one or more API ports enabled):
#   storageMode: "api"
#   utxorpcPort: 9090
#   blockfrostPort: 3100
#
# Validator / block producer (core storage, no APIs):
#   storageMode: "core"
#   blockProducer: true
#   shelleyVrfKey: "/keys/vrf.skey"
#   shelleyKesKey: "/keys/kes.skey"
#   shelleyOperationalCertificate: "/keys/opcert.cert"
#
# Dev mode (isolated, forge blocks, no outbound):
#   runMode: "dev"
# ---

# Ignore prior chain history and start from current tip (default: false)
# This is experimental and may break â€” use with caution
intersectTip: false

# Maximum total size (in bytes) of all transactions allowed in the mempool.
# Transactions exceeding this limit will be rejected.
# Default: 1048576 (1 MB)
mempoolCapacity: 1048576

# Operational mode: "serve" (default), "load", or "dev"
# - serve: Full node with network connectivity (default)
# - load: Batch import from ImmutableDB (requires immutableDbPath)
# - dev: Development mode (forge blocks, disable outbound, skip topology)
# Note: CLI commands (serve, load) take priority over this setting
#
# Can be overridden with the DINGO_RUN_MODE environment variable
runMode: "serve"

# Path to ImmutableDB for batch import (used when runMode is "load")
# Can also be provided as argument to 'dingo load' command
#
# Can be overridden with the DINGO_IMMUTABLE_DB_PATH environment variable
immutableDbPath: ""

# Validate historical blocks during ledger processing (default: false)
validateHistorical: false

# Peer targets - target number of peers in each state
# These are goals the system works toward, not hard limits.
# Use 0 for default values, -1 for unlimited
# Default: known=150, established=50, active=20
#
# Target number of known (cold) peers
targetNumberOfKnownPeers: 0
# Target number of established (warm) peers
targetNumberOfEstablishedPeers: 0
# Target number of active (hot) peers
targetNumberOfActivePeers: 0

# Per-source quotas for active peers
# These specify how active peer slots are distributed by source.
# Use 0 for default values.
# Default: topology=3, gossip=12, ledger=5
#
# Active peer slots for topology sources (local + public roots)
activePeersTopologyQuota: 0
# Active peer slots for gossip sources
activePeersGossipQuota: 0
# Active peer slots for ledger sources
activePeersLedgerQuota: 0

# Cache configuration for tiered CBOR cache system
# This controls the in-memory caching of UTxO and transaction CBOR data
cache:
  # Number of entries in the hot UTxO cache (LFU eviction)
  # Default: 50000
  hotUtxoEntries: 50000
  # Number of entries in the hot transaction cache (LFU eviction)
  # Default: 10000
  hotTxEntries: 10000
  # Maximum memory in bytes for hot transaction cache
  # Default: 268435456 (256 MB)
  hotTxMaxBytes: 268435456
  # Number of blocks to keep in the block LRU cache
  # Default: 500
  blockLruEntries: 500
  # Number of recent blocks to warm up on startup
  # Default: 1000
  warmupBlocks: 1000
  # Wait for cache warmup to complete before serving requests
  # Default: true
  warmupSync: true

# Mithril snapshot bootstrap configuration
# Use 'dingo mithril sync' or 'dingo sync --mithril' to bootstrap from a snapshot
mithril:
  # Enable Mithril integration (default: true)
  enabled: true
  # Override aggregator URL (auto-detected from network if empty)
  # Supported networks: mainnet, preprod, preview
  aggregatorUrl: ""
  # Directory for downloading snapshot archives
  # If empty, a randomized temporary directory is created automatically
  # downloadDir: ""
  # Remove temporary files after loading completes
  # Default: true
  cleanupAfterLoad: true
  # Verify the Mithril certificate chain from snapshot back to genesis
  # Default: true
  verifyCertificates: true
